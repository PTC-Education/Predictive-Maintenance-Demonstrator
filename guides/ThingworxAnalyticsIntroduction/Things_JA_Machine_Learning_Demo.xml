<?xml version="1.0" encoding="UTF-8" standalone="no"?><Entities build="b10877" majorVersion="9" minorVersion="1" modelPersistenceProviderPackage="PostgresPersistenceProviderPackage" revision="0" schemaVersion="1110" universal=""><Things><Thing description="" documentationContent="" effectiveThingPackage="RemoteThing" enabled="true" homeMashup="" identifier="" inheritedValueStream="" lastModifiedDate="2021-06-17T14:32:18.286Z" name="JA_Machine_Learning_Demo" projectName="ESRAP_2021_05_24" published="false" tags="" thingTemplate="RemoteThing" valueStream=""><Owner name="jaltenrie" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility/></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables><ConfigurationTable dataShapeName="" description="Reporting Settings" isMultiRow="false" name="ReportingConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.defaultValue="NotReporting" aspect.isPrimaryKey="true" aspect.isReadOnly="false" aspect.thingTemplate="ReportingStrategy" baseType="THINGNAME" description="Strategy to determine health" name="reportingStrategy" ordinal="1"/></FieldDefinitions></DataShape><Rows><Row><reportingStrategy><![CDATA[AlwaysOnReporting]]></reportingStrategy></Row></Rows></ConfigurationTable></ConfigurationTables><ThingShape><PropertyDefinitions><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isLogged="true" aspect.isPersistent="true" baseType="NUMBER" category="" description="" isLocalOnly="false" name="Goal" ordinal="14"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isLogged="true" aspect.isPersistent="true" baseType="NUMBER" category="" description="" isLocalOnly="false" name="smartServo1Angle" ordinal="2"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isLogged="true" aspect.isPersistent="true" baseType="NUMBER" category="" description="" isLocalOnly="false" name="smartServo1Current" ordinal="4"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isLogged="true" aspect.isPersistent="true" baseType="NUMBER" category="" description="" isLocalOnly="false" name="smartServo1Temp" ordinal="3"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isLogged="true" aspect.isPersistent="true" baseType="NUMBER" category="" description="" isLocalOnly="false" name="smartServo1Voltage" ordinal="5"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isLogged="true" aspect.isPersistent="true" baseType="NUMBER" category="" description="" isLocalOnly="false" name="smartServo2Angle" ordinal="6"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isLogged="true" baseType="NUMBER" category="" description="" isLocalOnly="false" name="smartServo2Current" ordinal="8"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isLogged="true" aspect.isPersistent="true" baseType="NUMBER" category="" description="" isLocalOnly="false" name="smartServo2Temp" ordinal="7"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isLogged="true" aspect.isPersistent="true" baseType="NUMBER" category="" description="" isLocalOnly="false" name="smartServo2Voltage" ordinal="9"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isLogged="true" baseType="NUMBER" category="" description="" isLocalOnly="false" name="smartServo3Angle" ordinal="10"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isLogged="true" baseType="NUMBER" category="" description="" isLocalOnly="false" name="smartServo3Current" ordinal="12"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isLogged="true" baseType="NUMBER" category="" description="" isLocalOnly="false" name="smartServo3Temp" ordinal="11"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isLogged="true" baseType="NUMBER" category="" description="" isLocalOnly="false" name="smartServo3Voltage" ordinal="13"/></PropertyDefinitions><ServiceDefinitions><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="prediction"><ResultType aspect.dataShape="AnalyticsPredictionScores" baseType="INFOTABLE" description="" name="result" ordinal="0"/><ParameterDefinitions/></ServiceDefinition></ServiceDefinitions><EventDefinitions/><ServiceMappings/><ServiceImplementations><ServiceImplementation description="" handlerName="Script" name="prediction"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[// create Infotable containing the features (properties) used for prediction
var modelFeatures = Resources["InfoTableFunctions"].CreateInfoTable({
	infoTableName: "modelFeatures" /* STRING */
});
// create the fields with the corresponding feature (property) name and description
modelFeatures.AddField({name:"name", baseType:"STRING"}); 
modelFeatures.AddField({name:"description", baseType:"STRING"});
// add a row for each feature (property)
modelFeatures.AddRow({name:"smartServo1Angle", description:""});
modelFeatures.AddRow({name:"smartServo1Temp", description:""});
modelFeatures.AddRow({name:"smartServo1Current", description:""});
modelFeatures.AddRow({name:"smartServo1Voltage", description:""});
modelFeatures.AddRow({name:"smartServo2Angle", description:""});
modelFeatures.AddRow({name:"smartServo2Temp", description:""});
modelFeatures.AddRow({name:"smartServo2Current", description:""});
modelFeatures.AddRow({name:"smartServo2Voltage", description:""});

/*  
 *  datasetref InfoTable containing the features (properties) with their current values -> 
 *  based on theses values the prediction will be executed
 */ 
var datasetref = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape({
	infoTableName: "datasetref" /* STRING */,
	dataShapeName: "AnalyticsDatasetRef" /* DATASHAPENAME */
});
// get all the property values from the properties specified in the modelFeatures Infotable
var data = me.GetNamedPropertyValues({
	propertyNames: modelFeatures /* INFOTABLE */
});
// write the properties with their values in the datasetref Infotable
datasetref.AddRow({data:data});



/*
 *  execute the prediction with the AnalyticsServer_PredictionThing RealtimeScore service
 *  predictiveScores: INFOTABLE; dataShape: "AnalyticsPredictionScores"
 */
var predictiveScores =  Things["EC2AMAZ-4HV0AJ2-AnalyticsServer_PredictionThing"].RealtimeScore({
	goalField: "smartServo3Angle" /* STRING */, 
	modelUri: "results:/models/22b380db-4253-48cb-b18e-28adfc4c456e" /* STRING */,  // change me!!
	datasetRef: datasetref /* INFOTABLE */,
});
// write the predicted goal to the me.Goal property
me.Goal = predictiveScores.rows[0].smartServo3Angle;
// return a Infotable containing the results of the prediction for the user
result = predictiveScores;]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation></ServiceImplementations><Subscriptions><Subscription description="" enabled="true" eventName="AnyDataChange" name="executePrediction" source="" sourceProperty="" sourceType="Thing"><ServiceImplementation description="" handlerName="Script" name="executePrediction"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[me.prediction();]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation></Subscription></Subscriptions></ThingShape><PropertyBindings/><RemotePropertyBindings/><RemoteServiceBindings/><RemoteEventBindings/><AlertConfigurations><AlertDefinitions name="Goal"/><AlertDefinitions name="smartServo1Angle"/><AlertDefinitions name="smartServo1Current"/><AlertDefinitions name="smartServo1Temp"/><AlertDefinitions name="smartServo1Voltage"/><AlertDefinitions name="smartServo2Angle"/><AlertDefinitions name="smartServo2Current"/><AlertDefinitions name="smartServo2Temp"/><AlertDefinitions name="smartServo2Voltage"/><AlertDefinitions name="smartServo3Angle"/><AlertDefinitions name="smartServo3Current"/><AlertDefinitions name="smartServo3Temp"/><AlertDefinitions name="smartServo3Voltage"/></AlertConfigurations><ImplementedShapes/><ThingProperties><reportingLastEvaluation><Value>1970-01-01T00:00:00.000Z</Value><Timestamp>1970-01-01T00:00:00.000Z</Timestamp><Quality>UNKNOWN</Quality></reportingLastEvaluation><reportingLastChange><Value>1970-01-01T00:00:00.000Z</Value><Timestamp>1970-01-01T00:00:00.000Z</Timestamp><Quality>UNKNOWN</Quality></reportingLastChange><lastConnection><Value>1970-01-01T00:00:00.000Z</Value><Timestamp>1970-01-01T00:00:00.000Z</Timestamp><Quality>UNKNOWN</Quality></lastConnection><smartServo1Angle><Value>58.0</Value><Timestamp>2021-05-24T13:55:54.653Z</Timestamp><Quality>GOOD</Quality></smartServo1Angle><smartServo1Temp><Value>37.0</Value><Timestamp>2021-05-24T13:55:54.653Z</Timestamp><Quality>GOOD</Quality></smartServo1Temp><Goal><Value>83.15655564104595</Value><Timestamp>2021-06-01T15:31:16.513Z</Timestamp><Quality>GOOD</Quality></Goal><smartServo2Angle><Value>150.0</Value><Timestamp>2021-05-24T13:55:54.653Z</Timestamp><Quality>GOOD</Quality></smartServo2Angle><smartServo1Voltage><Value>11.736</Value><Timestamp>2021-05-24T13:55:54.653Z</Timestamp><Quality>GOOD</Quality></smartServo1Voltage><smartServo2Voltage><Value>11.579</Value><Timestamp>2021-05-24T13:55:54.653Z</Timestamp><Quality>GOOD</Quality></smartServo2Voltage><smartServo1Current><Value>0.0</Value><Timestamp>2021-05-24T13:55:54.653Z</Timestamp><Quality>GOOD</Quality></smartServo1Current><smartServo2Temp><Value>37.0</Value><Timestamp>2021-05-24T13:55:54.653Z</Timestamp><Quality>GOOD</Quality></smartServo2Temp></ThingProperties><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="header : projectName : updated, name : updated&#10;" timestamp="2021-05-21T13:26:00.610Z" user="jaltenrie"/><ConfigurationChange changeAction="MODIFY" changeReason="services : prediction : service updated&#10;" timestamp="2021-05-21T13:39:34.511Z" user="jaltenrie"/><ConfigurationChange changeAction="MODIFY" changeReason="services : prediction : service updated&#10;" timestamp="2021-05-21T14:00:43.749Z" user="jaltenrie"/><ConfigurationChange changeAction="MODIFY" changeReason="subscriptions : executePrediction : removed&#10;" timestamp="2021-05-21T15:11:11.148Z" user="jaltenrie"/><ConfigurationChange changeAction="MODIFY" changeReason="subscriptions : executePrediction : added&#10;" timestamp="2021-05-21T15:11:52.267Z" user="jaltenrie"/><ConfigurationChange changeAction="MODIFY" changeReason="services : prediction : service updated&#10;" timestamp="2021-05-24T09:12:39.109Z" user="jaltenrie"/><ConfigurationChange changeAction="MODIFY" changeReason="services : prediction : service updated&#10;header : valueStream : updated&#10;" timestamp="2021-05-24T12:45:41.813Z" user="jaltenrie"/><ConfigurationChange changeAction="FORCEEDIT" changeReason="ForceEdit" timestamp="2021-06-17T14:32:18.290Z" user="mamueller"/></ConfigurationChanges></Thing></Things></Entities>